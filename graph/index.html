<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="../stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="../stylesheets/pygment_trac.css" media="screen">
    <link rel="stylesheet" type="text/css" href="../stylesheets/print.css" media="print">
    <script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>


    <script src="https://code.jquery.com/jquery-1.11.0.min.js"></script>
    <script src="https://code.jquery.com/jquery-migrate-1.2.1.min.js"></script>


    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">

    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap-theme.min.css">

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <title>Graph</title>
  </head>

  <body>
    <div id="container">
      <div class="inner">

        <header>
          <a href="../index.html"><h1><i style="color:#303030;">Ben</i>jamin <i style="color:#303030;">Derv</i>ille</h1></a>
          <a href="../index.html"><< Return to the homepage</a>
        </header>




        <hr>

        <section id="main_content">
          <h1>
            <a name="graph-visualisation" class="anchor" href="#graph-visualisation"><span class="octicon octicon-link"></span></a>
            Graph Visualisation
          </h1>

          <div id="graph">
          </div>
            <!-- here put the array -->
            <dl class="dl-horizontal">
              <dt>Nodes to visit</dt> <dd id="tovisit"></dd>
              <dt>Visited order</dt> <dd id="visited"></dd>        
            </dl>
          <hr>

          <h3>Algorithms</h3>
          <form class="form-inline" role="form">
          <select class="form-control" id="selectAlgo">
            <option>Breath First Search</option>
            <option>Depth First Search</option>
            <!-- implements other things ! -->
          </select>
          <!-- add refresh ? one step forward ? and other things ? -->
          <button type="button" class="btn btn-primary" onclick="buttonAlgo()">Go !</button>
          </form>

        </section>

        <footer>
          This page was generated by <a href="http://pages.github.com">GitHub Pages</a>. Tactile theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.
        </footer>




        <script type="text/javascript">



var width = 620,
    height = 550;

var color = d3.scale.category10();

var svg = d3.select("#graph").append("svg")
            .attr("width", width)
            .attr("height", height);

var nodes = {
         1: [2, 3, 4],
         2: [1, 5, 6],
         3: [1, 6],
         4: [1, 7, 8],
         5: [2, 9, 10],
         6: [2, 6],
         7: [4, 11, 12],
         8: [4],
         9: [5],
        10: [5],
        11: [7],
        12: [7]
    };

var nodesPos = {
    1 : {x: 50, y: 300},
    2 : {x: 200, y: 100},
    3 : {x: 200, y: 300},
    4 : {x: 200, y: 450},
    5 : {x: 350, y: 50},
    6 : {x: 350, y: 150},
    7 : {x: 350, y: 350},
    8 : {x: 350, y: 500},
    9 : {x: 500, y: 50},
    10 : {x: 500, y: 200},
    11 : {x: 500, y: 350},
    12 : {x: 500, y: 450},
}

var nodesPosC = [];
for (key in nodesPos) {
    nodesPosC.push({x: nodesPos[key].x, y: nodesPos[key].y, key: key});
}

var links = [];
for (var nodeId in nodes) {
    for (var i = 0; i < nodes[nodeId].length; i++) {
            links.push({source: nodesPos[parseInt(nodeId)], target: nodesPos[nodes[nodeId][i]]});
    };
}

var createGraph = function() {
  svg.selectAll(".line")
     .data(links)
     .enter()
     .append("line")
     .attr("x1", function(d) { return d.source.x })
     .attr("y1", function(d) { return d.source.y })
     .attr("x2", function(d) { return d.target.x })
     .attr("y2", function(d) { return d.target.y })
     .style("stroke", "rgb(6,120,155)")
     .style('stroke-width', '1.5px');


  var elemEnter = svg.selectAll("circle.nodes").data(nodesPosC).enter()
      .append("g")
      .attr("dx", function(d) { return d.x; })
      .attr("dy", function(d) { return d.y; })

      var circle = elemEnter.append("svg:circle")
          .attr("cx", function(d) { return d.x; })
          .attr("cy", function(d) { return d.y; })
          .attr("id", function(d) { return "key-"+d.key; })
          .attr("r", "20px")
          .attr("fill", "rgba(6,120,155,10)")

      elemEnter.append("text")
      .attr("dx", function(d) { return d.x; })
      .attr("dy", function(d) { return d.y; })
      .attr("text-anchor", "middle")
      .attr('color', "black")
      .style('text-shadow', 'none')
      .style('margin-top', '5px')
      .text(function(d) { return d.key; });  
  };

  var refreshGraph = function() {
    svg.selectAll("circle").attr('fill', function(d) { return "rgba(6,120,155,10)"; });
    tovisit = [1];  
    visited = [];
  }



  var tovisit = [1];  
  var visited = [];

  var child;
  var childs;


  var dfsOneStep = function() {
    child = tovisit.pop();

    if (visited.indexOf(child) === -1) {
        visited.push(child);
        childs = nodes[child];
        for (var i = childs.length -1; i >= 0 ; i--) {
            tovisit.push(childs[i]);
        };
        return child;
    }
  }


  var bfsOneStep = function() {
    var parent = tovisit.shift();
    childs = nodes[parent];
    for (var i = 0; i <= childs.length - 1; i++) {
        child = childs[i];
        if (visited.indexOf(child) === -1) {
            tovisit.push(child);
            visited.push(child);
        } 
    };
    return parent;
  }

  var updateVisited = function(node, time) {
      svg.select("#key-"+node).attr('fill', function(d) { return "#ccc"; });
      $("#tovisit").text(tovisit);
      $("#visited").text(visited);
  }


  var intervalID;

  var buttonAlgo = function() {
      var selectedAlgo = $("#selectAlgo").val();
      var fun;

      refreshGraph();
      clearInterval(intervalID);
      if (selectedAlgo === "Breath First Search") {
          fun = bfsOneStep;
          visited = [1];
          updateVisited(1);
      } else {
          fun = dfsOneStep;
      }
      intervalID = setInterval(function(){
        child = fun();
        updateVisited(child);
      }, 500);

  };


createGraph();



var bfs = function(start, end, nodes, fun) {
    var tovisit = [start];  
    var visited = [start];
    fun(start);
    var child;
    var childs;

    var n_ite = 1;
    while (0 <  tovisit.length) {
        n_ite = n_ite +1;
        childs = nodes[tovisit.shift()];
        for (var i = 0; i <= childs.length - 1; i++) {
            child = childs[i];
            if (visited.indexOf(child) === -1) {
                tovisit.push(child);
                fun(child, n_ite);
                visited.push(child);
            } 
        };
    }
    return visited;
}


var dfs = function(start, end, nodes, fun) {
    var tovisit = [start];  
    var visited = [];

    var child;
    var childs;

    var n_ite = 0;
    while (0 <  tovisit.length) {
        child = tovisit.pop();

        if (visited.indexOf(child) === -1) {
            n_ite = n_ite + 1;
            visited.push(child);
            fun(child, n_ite);
            childs = nodes[child];
            for (var i = childs.length -1; i >= 0 ; i--) {
                tovisit.push(childs[i]);
            };
        }
    }
    return visited;
}



        </script>
















          <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-55163801-2");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

      </div>
    </div>
  </body>
</html>