<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link rel="stylesheet" type="text/css" href="../data/bootstrap.css" media="screen">
    <link rel="stylesheet" type="text/css" href="../stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="../stylesheets/pygment_trac.css" media="screen">
    <link rel="stylesheet" type="text/css" href="../stylesheets/print.css" media="print">
    <link rel="stylesheet" type="text/css" href="../stylesheets/styles.css" media="screen">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
    <script src="https://code.jquery.com/jquery-1.11.0.min.js"></script>
    <script src="https://code.jquery.com/jquery-migrate-1.2.1.min.js"></script>

    <link rel="icon" href="../data/favicon.png">
    <link rel="icon" href="../data/favicon.svg">
    <title>Graph</title>
  </head>

  <body>
    <a href="http://benderv.com" class="header"><header>
    <h1>Benjamin Derville</h1>
    <h2>CS student / autodidact</h2>
    </header></a>

    <section class="code">
      <div class="container">
        <div class="row">
            <div class="col-sm-8 col-sm-offset-2">
<pre class="codehilite"><code class="python">>>> <span class="n">position</span> <span class="o">=</span> <span class="s">"Fullstack engineer"</span>
>>> <span class="n">job</span> <span class="o">=</span> <span class="s">False</span> 
>>> <span class="n">available</span> <span class="o">=</span> <span class="bp">True</span> <span class="c"># from September 2016 </span>
>>> <span class="n">mail</span> <span class="o">=</span> <span class="s"><a href="mailto:benderville@gmail.com">"benderville@gmail.com"</a></span></code></pre>
          </div>
        </div>
      </div>
    </section>


    <section class="graph">
      <div class="container">
        <div class="row">
          <h2>Graph Visualisation</h2>
          <div id="graph" class="col-sm-8">
          
          </div>
            
          <div class="col-sm-4">
            <label>Algorithms</label><br/>
            <div class="btn-group">
              <select class="c-select" id="selectAlgo">
                <option selected>Breath First Search</option>
                <option>Depth First Search</option>
              </select>
            </div>
            <button type="button" class="btn btn-primary" onclick="buttonAlgo()">Go !</button>
            <hr/>
            <!-- here put the array -->
            <dl class="dl-horizontal">
              <dt>Nodes to visit</dt> <dd id="tovisit"></dd>
              <dt>Visited order</dt> <dd id="visited"></dd>        
            </dl>
          </div>
        </div>
      </div>

      
    </section>



<script type="text/javascript">


var width = 620,
    height = 550;

var color = d3.scale.category10();

var svg = d3.select("#graph").append("svg")
            .attr("width", width)
            .attr("height", height);

var nodes = {
         1: [2, 3, 4],
         2: [1, 5, 6],
         3: [1, 6],
         4: [1, 7, 8],
         5: [2, 9, 10],
         6: [2, 6],
         7: [4, 11, 12],
         8: [4],
         9: [5],
        10: [5],
        11: [7],
        12: [7]
    };

var nodesPos = {
    1 : {x: 50, y: 300},
    2 : {x: 200, y: 100},
    3 : {x: 200, y: 300},
    4 : {x: 200, y: 450},
    5 : {x: 350, y: 50},
    6 : {x: 350, y: 150},
    7 : {x: 350, y: 350},
    8 : {x: 350, y: 500},
    9 : {x: 500, y: 50},
    10 : {x: 500, y: 200},
    11 : {x: 500, y: 350},
    12 : {x: 500, y: 450},
}

var nodesPosC = [];
for (key in nodesPos) {
    nodesPosC.push({x: nodesPos[key].x, y: nodesPos[key].y, key: key});
}

var links = [];
for (var nodeId in nodes) {
    for (var i = 0; i < nodes[nodeId].length; i++) {
            links.push({source: nodesPos[parseInt(nodeId)], target: nodesPos[nodes[nodeId][i]]});
    };
}

var createGraph = function() {
  svg.selectAll(".line")
     .data(links)
     .enter()
     .append("line")
     .attr("x1", function(d) { return d.source.x })
     .attr("y1", function(d) { return d.source.y })
     .attr("x2", function(d) { return d.target.x })
     .attr("y2", function(d) { return d.target.y })
     .style("stroke", "#ecf0f1")
     .style('stroke-width', '1.5px');


  var elemEnter = svg.selectAll("circle.nodes").data(nodesPosC).enter()
      .append("g")
      .attr("dx", function(d) { return d.x; })
      .attr("dy", function(d) { return d.y; })

      var circle = elemEnter.append("svg:circle")
          .attr("cx", function(d) { return d.x; })
          .attr("cy", function(d) { return d.y; })
          .attr("id", function(d) { return "key-"+d.key; })
          .attr("r", "20px")
          .attr("fill", "#2c3e50")

      elemEnter.append("text")
      .attr("dx", function(d) { return d.x; })
      .attr("dy", function(d) { return d.y + 5; })
      .attr("text-anchor", "middle")
      .attr('fill', "white")
      .style('text-shadow', 'none')
      .text(function(d) { return d.key; });  
  };

  var refreshGraph = function() {
    svg.selectAll("circle").attr('fill', function(d) { return "#ecf0f1"; });
    tovisit = [1];  
    visited = [];
  }



  var tovisit = [1];  
  var visited = [];

  var child;
  var childs = [];


  var dfsOneStep = function() {
    child = tovisit.pop();

    if (visited.indexOf(child) === -1) {
        visited.push(child);
        childs = nodes[child];
        console.log(childs);
        if (typeof childs != 'undefined') {
          for (var i = childs.length - 1; i >= 0 ; i--) {
            tovisit.push(childs[i]);
          };
        }
        return child;
    }
  }


  var bfsOneStep = function() {
    var parent = tovisit.shift();
    childs = nodes[parent];
    if (typeof childs != 'undefined') {
      for (var i = 0; i <= childs.length - 1; i++) {
          child = childs[i];
          if (visited.indexOf(child) === -1) {
              tovisit.push(child);
              visited.push(child);
          } 
      };
    }
    return parent;
  }

  var updateVisited = function(node, time) {
      svg.select("#key-"+node).attr('fill', function(d) { return "#2c3e50"; });
      $("#tovisit").text(tovisit);
      $("#visited").text(visited);
  }


  var intervalID;

  var buttonAlgo = function() {
      var selectedAlgo = $("#selectAlgo").val();
      var fun;

      refreshGraph();
      clearInterval(intervalID);
      if (selectedAlgo === "Breath First Search") {
          fun = bfsOneStep;
          visited = [1];
          updateVisited(1);
      } else {
          fun = dfsOneStep;
      }
      intervalID = setInterval(function(){
        child = fun();
        updateVisited(child);
      }, 500);

  };


createGraph();



var bfs = function(start, end, nodes, fun) {
    var tovisit = [start];  
    var visited = [start];
    fun(start);
    var child;
    var childs;

    var n_ite = 1;
    while (0 <  tovisit.length) {
        n_ite = n_ite +1;
        childs = nodes[tovisit.shift()];
        for (var i = 0; i <= childs.length - 1; i++) {
            child = childs[i];
            if (visited.indexOf(child) === -1) {
                tovisit.push(child);
                fun(child, n_ite);
                visited.push(child);
            } 
        };
    }
    return visited;
}


var dfs = function(start, end, nodes, fun) {
    var tovisit = [start];  
    var visited = [];

    var child;
    var childs;

    var n_ite = 0;
    while (0 <  tovisit.length) {
        child = tovisit.pop();

        if (visited.indexOf(child) === -1) {
            n_ite = n_ite + 1;
            visited.push(child);
            fun(child, n_ite);
            childs = nodes[child];
            for (var i = childs.length -1; i >= 0 ; i--) {
                tovisit.push(childs[i]);
            };
        }
    }
    return visited;
}

</script>



  <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
  </script>
  <script type="text/javascript">
    try {
      var pageTracker = _gat._getTracker("UA-55163801-2");
    pageTracker._trackPageview();
    } catch(err) {}
  </script>

      </div>
    </div>
  </body>
</html>